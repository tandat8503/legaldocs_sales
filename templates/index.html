<!DOCTYPE html>
<html>
  <head>
    <title>Legal Contract AI Agent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 40px;
      }
      textarea {
        width: 100%;
        height: 150px;
      }
      .result {
        background: #f9f9f9;
        border: 1px solid #ccc;
        padding: 15px;
        margin-top: 20px;
      }
      .btn {
        padding: 10px 20px;
        margin: 5px;
      }
      .error {
        color: red;
        font-weight: bold;
        margin-bottom: 15px;
      }
      .section-title {
        margin-top: 30px;
      }
    </style>
  </head>
  <body>
    <h1>Legal Contract AI Agent</h1>
    <form method="post" enctype="multipart/form-data">
      {% if not contract %}
      <label for="contract"><b>Upload contract (.txt, .pdf, .docx):</b></label
      ><br />
      <input
        type="file"
        name="contract"
        id="contract"
        required
        title="Upload contract file"
      /><br /><br />
      {% endif %}
      <label for="user_question"
        ><b>Enter your legal question about the contract:</b></label
      ><br />
      <textarea
        name="user_question"
        id="user_question"
        rows="4"
        style="width: 100%"
        required
      >
{{ request.form.user_question or '' }}</textarea
      ><br />
      <button class="btn" type="submit">Submit Question</button>
      {% if contract %}
      <button class="btn" type="submit" name="finish_session" value="1">
        Finish Session
      </button>
      <button class="btn" type="submit" name="upload_new_contract" value="1">
        Upload new contract
      </button>
      {% endif %}
    </form>
    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %} {% if answer %}
    <div class="result">
      <h3>Answer:</h3>
      <div style="white-space: pre-wrap">{{ answer }}</div>
    </div>
    {% endif %} {% if relevant_law_sections and relevant_law_sections|length > 0
    %}
    <div class="result">
      <h3 class="section-title">Relevant Law Sections:</h3>
      <ul>
        {% for section in relevant_law_sections %}
        <li style="margin-bottom: 15px">
          <b>File:</b> {{ section.filename }}<br />
          <!-- <b>Score:</b> {{ '%.3f'|format(section.score) }}<br /> -->
          <b>Content:</b>
          <span style="white-space: pre-wrap"
            >{{ section.chunk[:300] }}{% if section.chunk|length > 300 %}...{%
            endif %}</span
          >
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </body>
</html>
